{"version":3,"sources":["data.js","../node_modules/isobject/index.js","../node_modules/is-plain-object/index.js","rendering-scheduler.js","fhtml.js"],"names":["Data","isUndefined","value","isArray","Array","isFunction","fn","toString","call","formatBasePath","basePath","resolve","path","obj","self","separator","properties","split","length","reduce","prev","curr","sourceOfTruth","subscribers","entries","DataInterpreter","bind","prototype","extract","get","set","pathsObject","map","_path","valueIsFunction","pathArray","unshift","property","pop","objectPath","join","object","oldValue","notifySubscribers","emitSubscriber","subscriber","newValue","forEach","deep","substr","subscribe","id","Date","now","formatedPath","some","push","unsubscribe","filter","toJSON","module","exports","val","isObject","require","isObjectObject","o","Object","ctor","prot","constructor","hasOwnProperty","RenderingScheduler","queue","Set","loop","tick","window","requestAnimationFrame","renderQueue","add","renderer","has","render","renderTimestamp","_render","delete","fhtml","renderingScheduler","isEmptyArray","isHtmlElement","Element","isComponent","$el","isComponentArray","arr","every","isTextNode","nodeType","Node","TEXT_NODE","renderAsSvg","string","search","fhtmlFn","fhtmlFnWholeExpression","isFhtmlFn","createRenderContext","def","document","createElementNS","createElement","createTemplate","strings","expressions","i","expr","isProxy","propertyNames","Map","getPropertyNameFromLowerCase","node","lowerCasePropertyName","prop","toLowerCase","Symbol","createComponentProxy","data","Proxy","apply","target","thisArg","argumentsList","createproxy","f","rendererData","createContentProxy","type","dataType","createSubscribers","state","props","attrs","attr","sharedRendererMethods","component","isStatic","resetPropSubscribers","$props","$state","$data","$attrs","_isStatic","linkDirective","renderers","linkEvent","event","eventHandler","e","hook","mounted","addEventListener","unmounted","removeEventListener","linkAttributeOrProperty","isProperty","attribute","undefined","classNames","keys","key","setAttribute","k","style","setProperty","transformObject","transformString","method","transform","dataset","JSON","stringify","linkAttributesPropsDirectives","getFn","replace","attributes","valueIsFn","nameIsFn","name","startsWith","isEvent","parsedAttributeName","whole","char","toUpperCase","removeAttribute","linkContent","childNodes","childNode","textContent","subChildText","createTextNode","cache","textNode","placeholderNode","createComment","getCachedComponent","_map","v","childComponentProps","childComponent","newVal","replaceContent","subChildNode","placeholder","parentNode","insertBefore","removeChild","getElements","x","getComponents","y","parentComponent","newElements","oldElements","newComponents","oldComponents","firstNode","lastNode","firstNodePlaceholder","lastNodePlaceholder","componentsToBeUnmounted","includes","componentsToBeMounted","nextSibling","lifeCycle","el","firstIndex","indexOf","nodeOnIndex","isSameNode","insertData","setWatchers","watchers","watcher","handler","args","fhtml_placeholder","arguments","slice","componentState","componentData","componentProps","componentAttrs","componentWatchers","template","$ctx","insertAdjacentHTML","mount","unmount","returnPlaceholder","replaceChild","watch","children","querySelectorAll"],"mappings":"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","file":"fhtml.map","sourceRoot":"../src","sourcesContent":["const isUndefined = value => typeof value === 'undefined'\nconst isArray = value => Array.isArray(value)\nconst isFunction = fn => fn && {}.toString.call(fn) === '[object Function]'\nconst formatBasePath = basePath => basePath !== ''\n  ? `${basePath}.`\n  : ''\nconst resolve = function(path, obj = self, separator = '.') {\n  const properties = Array.isArray(path) ? path : path.split(separator)\n  if (properties.length === 1)\n    return obj[properties[0]]\n  return properties.reduce((prev, curr) => {\n    return prev && prev[curr]\n  }, obj)\n}\nfunction Data(sourceOfTruth, basePath, subscribers) {\n  this.sourceOfTruth = sourceOfTruth || {}\n  this.basePath = basePath || ''\n  this.subscribers = subscribers || {\n    entries: []\n  }\n  return this.DataInterpreter.bind(this)\n}\nData.prototype.extract = function(path) {\n  return new Data(\n    this.sourceOfTruth,\n    `${formatBasePath(this.basePath)}${path}`,\n    this.subscribers\n  )\n}\nData.prototype.DataInterpreter = function DataInterpreter(path, value) {\n  if (!isUndefined(path) && isUndefined(value))\n    return this.get(path)\n  if (!isUndefined(path) && typeof !isUndefined(value))\n    return this.set(path, value)\n  return this\n}\nData.prototype.get = function(path) {\n  if (isArray(path)) {\n    const pathsObject = {}\n    const pathsArray = path.map(path => {\n      pathsObject[path] = this.get(path)\n    })\n    return pathsObject\n  }\n  if (!isUndefined(path))\n    return resolve(`${formatBasePath(this.basePath)}${path}`, this.sourceOfTruth)\n  return this\n}\nData.prototype.set = function(_path, value, valueIsFunction = false, addToHistory = true) {\n  const path = `${formatBasePath(this.basePath)}${_path}`\n  const pathArray = path.split('.')\n  pathArray.unshift('sourceOfTruth')\n  const property = pathArray.pop()\n  const objectPath = pathArray.join('.')\n  const object = resolve(objectPath, this)\n  const oldValue = object[property]\n  object[property] = isFunction(value) && !valueIsFunction\n    ? value(resolve(path, this.sourceOfTruth))\n    : value;\n  this.notifySubscribers(path, oldValue)\n  return this\n}\nData.prototype.emitSubscriber = function(subscriber) {\n  \n  const newValue = resolve(subscriber.path, this.sourceOfTruth)\n  if (newValue === subscriber.value)\n    return\n  subscriber.fn(newValue, subscriber.value ? subscriber.value : false, subscriber.path)\n  subscriber.value = newValue\n  // if (JSON.stringify(newValue) === subscriber.value)\n  //   return\n  // subscriber.fn(newValue, subscriber.value ? JSON.parse(subscriber.value) : false, subscriber.path)\n  // subscriber.value = JSON.stringify(newValue)\n}\nData.prototype.notifySubscribers = function(path, oldValue) {\n  this.subscribers.entries\n    .forEach(subscriber => {\n      if (subscriber.deep && subscriber.path === path.substr(0, subscriber.path.length)) {\n        this.emitSubscriber(subscriber)\n      }\n      else if (subscriber.path === path) {\n        this.emitSubscriber(subscriber)\n      }\n      else if (path === subscriber.path.substr(0, path.length)) {\n        this.emitSubscriber(subscriber)\n      }\n    })\n}\n\nData.prototype.subscribe = function(path, fn = false, id = Date.now(), deep = false) {\n  const subscribe = path => {\n    const formatedPath = `${formatBasePath(this.basePath)}${path}`\n    if (this.subscribers.entries.some(subscriber => {\n      return subscriber.path === formatedPath && subscriber.fn === fn\n    })) return\n    this.subscribers.entries.push({\n      path: formatedPath,\n      fn,\n      deep,\n      id: id\n    })\n  }\n  if (isArray(path))\n    path.forEach(subscribe)\n  else\n    subscribe(path)\n  return this\n}\nData.prototype.unsubscribe = function(path = false, fn = false, id = false) {\n  this.subscribers.entries = this.subscribers.entries.filter(subscriber => {\n    if (id)\n      return subscriber.id !== id\n    if (path && fn)\n      return subscriber.path !== path && subscriber.fn !== fn\n    else if (path && !fn)\n      return subscriber.path !== path || subscriber !== path\n    else if (!path && fn)\n      return subscriber.fn !== fn\n  })\n  return this\n}\nData.prototype.toJSON = function() {\n  if (this.basePath)\n    return resolve(this.basePath,this.sourceOfTruth)\n  else\n    return this.sourceOfTruth\n}\n\nexport default Data\n","/*!\n * isobject <https://github.com/jonschlinkert/isobject>\n *\n * Copyright (c) 2014-2017, Jon Schlinkert.\n * Released under the MIT License.\n */\n\n'use strict';\n\nmodule.exports = function isObject(val) {\n  return val != null && typeof val === 'object' && Array.isArray(val) === false;\n};\n","/*!\n * is-plain-object <https://github.com/jonschlinkert/is-plain-object>\n *\n * Copyright (c) 2014-2017, Jon Schlinkert.\n * Released under the MIT License.\n */\n\n'use strict';\n\nvar isObject = require('isobject');\n\nfunction isObjectObject(o) {\n  return isObject(o) === true\n    && Object.prototype.toString.call(o) === '[object Object]';\n}\n\nmodule.exports = function isPlainObject(o) {\n  var ctor,prot;\n\n  if (isObjectObject(o) === false) return false;\n\n  // If has modified constructor\n  ctor = o.constructor;\n  if (typeof ctor !== 'function') return false;\n\n  // If has modified prototype\n  prot = ctor.prototype;\n  if (isObjectObject(prot) === false) return false;\n\n  // If constructor does not have an Object-specific method\n  if (prot.hasOwnProperty('isPrototypeOf') === false) {\n    return false;\n  }\n\n  // Most likely a plain Object\n  return true;\n};\n","const RenderingScheduler = function() {\n  this.queue = new Set()\n  this.now = Date.now()\n\n  const loop = () => {\n    this.tick()\n    window.requestAnimationFrame(loop)\n  }\n  loop()\n}\nRenderingScheduler.prototype.tick = function() {\n  this.now = Date.now()\n  this.renderQueue()\n}\nRenderingScheduler.prototype.add = function(renderer) {\n  if (this.queue.has(renderer))\n    return\n  this.queue.add(renderer)\n}\nRenderingScheduler.prototype.renderQueue = function() {\n  this.queue.forEach(renderer => {\n    this.render(renderer)\n  })\n}\nRenderingScheduler.prototype.render = function(renderer) {\n  if (renderer.renderTimestamp < this.now) {\n    renderer._render()\n    renderer.renderTimestamp = this.now\n  }\n  this.queue.delete(renderer)\n}\n\nexport default RenderingScheduler","import Data from './data';\nimport isPlainObject from 'is-plain-object'\nimport RenderingScheduler from './rendering-scheduler'\nconst renderingScheduler = new RenderingScheduler()\n\nconst isFunction = fn => fn && {}.toString.call(fn) === '[object Function]'\nconst isArray = value => Array.isArray(value)\nconst isEmptyArray = value => isArray(value) && value.length === 0\nconst isHtmlElement = obj => obj instanceof Element\nconst isComponent = obj => obj && obj.$el && isHtmlElement(obj.$el)\nconst isComponentArray = arr =>\n  isArray(arr) && arr.length &&\n  arr.every(value => isComponent(value))\nconst isTextNode = obj => obj.nodeType === Node.TEXT_NODE\nconst isUndefined = value => typeof value === 'undefined'\nconst renderAsSvg = string => string.search(/<!--?(\\s*)svg?(\\s*)-->/gmi) !== -1\nconst fhtmlFn = /fhtmlfn\\((\\d+)\\)/g\nconst fhtmlFnWholeExpression = /(fhtmlfn\\(\\d+\\))/gm\nconst isFhtmlFn = string => string.search(fhtmlFn) !== -1\n\nconst createRenderContext = def => {\n  if (renderAsSvg(def))\n    return document.createElementNS('http://www.w3.org/2000/svg', 'svg')\n  return document.createElement('span')\n}\n\nconst createTemplate = (strings, expressions) => strings.map((string, i) => {\n  const expr = expressions[i]\n  if (!expr)\n    return string\n  if (expr[isProxy]) {\n    expressions[i] = () => expr()\n    return `${string}fhtmlfn(${i})`\n  }\n  if (isFunction(expr))\n    return `${string}fhtmlfn(${i})`\n  if (\n    isHtmlElement(expr) || \n    isComponent(expr) || \n    isComponentArray(expr) || \n    isPlainObject(expr)\n  ) {\n    expressions[i] = () => expr\n    return `${string}fhtmlfn(${i})`\n  }\n  return `${string}${expr}`\n}).join('')\n\nconst propertyNames = new Map()\n\nconst getPropertyNameFromLowerCase = (node, lowerCasePropertyName) => {\n  if (propertyNames.has(lowerCasePropertyName))\n    return propertyNames.get(lowerCasePropertyName)\n  for (let prop in node) {\n    if (prop.toLowerCase() === lowerCasePropertyName) {\n      propertyNames.set(lowerCasePropertyName, prop)\n      return prop\n    }\n  }\n  return lowerCasePropertyName\n}\nconst isProxy = Symbol('isProxy')\n\nconst createComponentProxy = (data, path = '') =>  new Proxy(() => {}, {\n  apply(target, thisArg, argumentsList) {\n    if (!path)\n      return data\n    const value = argumentsList[0]\n    if (!isUndefined(value))\n      return data(path)\n    return data(path, value)\n  },\n  get(obj, prop, value) {\n    if (prop === isProxy)\n      return true\n    return createComponentProxy(data, `${path ? `${path}.` : ''}${prop}`)\n  }\n})\n\nconst createproxy = (f, data, subscribers, path = '') =>  new Proxy(() => {}, {\n  apply(target, thisArg, argumentsList) {\n    const value = argumentsList[0]\n    if (!isUndefined(value))\n      rendererData.bind(f())(data(), subscribers, path, value)\n    return rendererData.bind(f())(data(), subscribers, path)\n  },\n  get(obj, prop, value) {\n    if (prop === isProxy)\n      return true\n    return createproxy(f, data, subscribers, `${path ? `${path}.` : ''}${prop}`)\n  }\n})\n\nconst createContentProxy = (f, type, dataType = '', path = '') => new Proxy(() => {}, {\n  apply(target, thisArg, argumentsList) {\n    const fn = argumentsList[0]\n    return f()[type](dataType, path, fn)\n  },\n  get(obj, prop) {\n    return createContentProxy(\n      f, type,\n      dataType ? dataType : prop, \n      `${path ? `${path}.` : ''}${dataType ? prop : ''}`\n    )\n  }\n})\n\nfunction rendererData(data, subscribers, path, value) {\n  if (\n    !subscribers.some(subscriber => subscriber.path === path) && \n    path && \n    isUndefined(value))\n  {\n    subscribers.push({path, id: this})\n    data().subscribe(path, () => this.render(), this)\n  }\n  return data(path, value)\n}\n\nconst createSubscribers = () => ({\n  state: [],\n  data: [],\n  props: [],\n  attrs: []\n})\n\nconst dataType = {\n  state: '$state',\n  data: '$data',\n  prop: '$props',\n  attr: '$attrs'\n}\n\nconst sharedRendererMethods = (fn, node, component) => {\n  const subscribers = createSubscribers()\n  let isStatic = false\n  const renderer = {\n    fn,\n    node,\n    resetPropSubscribers() {\n      if (!subscribers.props.length)\n        return\n      subscribers.props.forEach(subscriber => {\n        component.$props().unsubscribe(false, false, subscriber.id)\n      })\n      subscribers.props = []\n    },\n    state: createproxy(() => renderer, () => component.$state, subscribers.state),\n    data: createproxy(() => renderer, () => component.$data, subscribers.data),\n    prop: createproxy(() => renderer, () => component.$props, subscribers.props),\n    attr: createproxy(() => renderer, () => component.$attrs, subscribers.attrs),\n    renderTimestamp: 0,\n    render() {\n      renderingScheduler.add(renderer)\n    },\n    _render() {},\n    get _isStatic() {\n      return isStatic\n    },\n    get isStatic() {\n      return isStatic = true\n    }\n  }\n  return renderer\n}\n\nconst linkDirective = (node, fn, renderers, component) => {\n  const renderer = sharedRendererMethods(fn, node, component)\n  renderer._render = () => {\n    if (renderer._isStatic)\n      return\n    renderer.fn(renderer)\n  }\n  renderers.push(renderer)\n}\n\nconst linkEvent = (event, node, fn, renderers, component) => {\n  \n  const renderer = sharedRendererMethods(fn, node, component)\n  \n  const eventHandler = e => fn(renderer, e)\n  const lifeCycleHooks = ['beforemount','mounted','beforeunmount','unmounted']\n  const isLifeCycleEvent = lifeCycleHooks.some(hook => hook === event)\n  if (isLifeCycleEvent)\n    renderer[event] = fn\n  else {\n    renderer.mounted = () => node.addEventListener(event, eventHandler)\n    renderer.unmounted = () => node.removeEventListener(event, eventHandler)\n  }\n  renderers.push(renderer)\n}\n\nconst linkAttributeOrProperty = (isProperty, attribute, node, fn, renderers, component) => {\n  const property = isProperty\n    ? getPropertyNameFromLowerCase(node, attribute)\n    : attribute\n\n  const renderer = sharedRendererMethods(fn, node, component)\n  renderer.value = undefined\n  renderer._render = () => {\n    if (renderer._isStatic)\n      return\n    const newValue = renderer.fn(renderer)\n    if (isUndefined(newValue) || newValue === renderer.value)\n      return\n    if (isPlainObject(newValue) && attribute === 'class') {\n      const classNames = Object.keys(newValue)\n        .filter(key => newValue[key])\n        .join(' ')\n      node.setAttribute(attribute, classNames)\n    }\n    else if (isPlainObject(newValue) && attribute === 'style') {\n      for (let k in newValue) {\n        // Set CSS Variable\n        if (k.substr(0,2) === '--')\n          node.style.setProperty(k, newValue[k])\n        // Set CSS property\n        else {\n          if (k === 'transform' && isPlainObject(newValue[k])) {\n            const transformObject = newValue[k]\n            const transformString = Object.keys(newValue[k])\n              .map(method => `${method}(${transformObject[method]})`)\n              .join(' ')\n            node.style.transform = transformString\n          }\n          node.style[k] = newValue[k]\n        }\n      }\n    }\n    else if (isPlainObject(newValue) && attribute === 'dataset') {\n      for (let k in newValue) {\n        node.dataset[k] = JSON.stringify(newValue[k])\n      }\n    }\n    else if (isProperty) {\n      node[property] = newValue\n    }\n    else {\n      node.setAttribute(attribute, newValue)\n    }\n    renderer.value = newValue \n  }\n  renderers.push(renderer)\n}\n\nconst linkAttributesPropsDirectives = (node, expressions, renderers, component) => {\n  const getFn = value => expressions[value.replace(fhtmlFn, '$1')]\n  ;[...node.attributes]\n    .forEach(attribute => {\n      const valueIsFn = isFhtmlFn(attribute.value)\n      const nameIsFn = isFhtmlFn(attribute.name)\n      if (!valueIsFn && !nameIsFn)\n        return\n\n      const isProperty = attribute.name.startsWith('.')\n      const isEvent = attribute.name.startsWith('@')\n      const isAttribute = !isProperty && !isEvent\n      const parsedAttributeName = attribute.name\n        .replace(/\\./g, '')\n        .replace(/:/g, '')\n        .replace(/@/g, '')\n        .replace(/\\^([a-z])/g, (whole, char) => char.toUpperCase())\n\n      if (isEvent)\n        linkEvent(parsedAttributeName, node, getFn(attribute.value), renderers, component)\n      if (valueIsFn && !isEvent)\n        linkAttributeOrProperty(isProperty, parsedAttributeName, node, getFn(attribute.value), renderers, component)\n      else if (nameIsFn)\n        linkDirective(node, getFn(attribute.name), renderers, component)\n      node.removeAttribute(attribute.name)\n    })\n}\n\nconst linkContent = (node, expressions, renderers, component) => {\n  [...node.childNodes]\n    .filter(childNode => isTextNode(childNode))\n    .forEach(childNode => {\n      if (!isFhtmlFn(childNode.textContent))\n        return\n      childNode.textContent\n        .split(fhtmlFnWholeExpression)\n        .map(subChildText => {\n          if (!isFhtmlFn(subChildText))\n            return document.createTextNode(subChildText)\n          const fn = expressions[\n            subChildText.replace(fhtmlFn, '$1')\n          ]\n          const cache = new Map()\n          const textNode = document.createTextNode('')\n          const placeholderNode = document.createComment('')\n          const renderer = sharedRendererMethods(fn, node, component)\n          renderer.value = placeholderNode\n          renderer.cache = (key, fn) => getCachedComponent(cache, key, fn)\n          renderer.map = createContentProxy(() => renderer, '_map')\n          renderer._map = (type, value, fn = v => v) => {\n            const $data = component[dataType[type]]\n            return renderer[type][value]().map((key, i, arr) => {\n              const childComponentProps = (prop, newVal) => $data().extract(`${value}.${i}`)\n              const props = renderer[type][value][i]\n              const childComponent = getCachedComponent(cache, key, () => \n                fn(props, i, arr)\n              )\n              if (isComponent(childComponent)) {\n                childComponent.props(childComponentProps)\n                childComponent.renderers.forEach(renderer => {\n                  renderer.resetPropSubscribers()\n                })\n              }\n              return childComponent\n            })\n          }\n          renderer._render = () => {\n            if (renderer._isStatic)\n              return\n            let newValue = renderer.fn(renderer)\n            if (newValue === renderer.value)\n              return\n            if (isTextNode(renderer.value) && newValue === textNode.textContent)\n              return\n            if (!newValue || isEmptyArray(newValue)) {\n              if (renderer.value === placeholderNode)\n                return\n              replaceContent(component, placeholderNode, renderer.value)\n              renderer.value = placeholderNode\n            }\n            else if (\n              isHtmlElement(newValue) ||\n              isComponent(newValue) ||\n              isComponentArray(newValue)\n            ) {\n              replaceContent(component, newValue, renderer.value)\n              renderer.value = newValue\n            }\n            else {\n              if (renderer.value.textContent && `${newValue}` === `${renderer.value.textContent}`)\n                return\n              textNode.textContent = newValue\n              replaceContent(component, textNode, renderer.value)\n              renderer.value = textNode\n            }\n          }\n          renderers.push(renderer)\n          return renderer.value\n        })\n        .forEach(subChildNode => {\n          const placeholder = document.createComment('')\n          childNode.parentNode.insertBefore(placeholder, childNode)\n          replaceContent(component, subChildNode, placeholder)\n        })\n      childNode.parentNode.removeChild(childNode)\n  })\n}\n\nconst getElements = x => isArray(x)\n  ? [...x].map(value => isComponent(value) ? value.$el : value)\n  : [isComponent(x) ? x.$el : x]\n\nconst getComponents = x => isArray(x)\n  ? x.filter(y => isComponent(y))\n  : isComponent(x) ? [x] : []\n\nconst replaceContent = (parentComponent, newValue, oldValue) => {\n\n  // Detect when all the values are the same\n  if (!isArray(newValue) && newValue === oldValue)\n    return\n  if (\n    isArray(newValue) &&\n    isArray(oldValue) &&\n    newValue.every((newValue, i) => newValue === oldValue[i]) &&\n    newValue.length === oldValue.length\n  ) return\n\n  const newElements = getElements(newValue)\n  const oldElements = getElements(oldValue)\n  const newComponents = getComponents(newValue)\n  const oldComponents = getComponents(oldValue)\n  const firstNode = oldElements[0]\n  const lastNode = oldElements[oldElements.length-1]\n  const parentNode = firstNode.parentNode\n  const firstNodePlaceholder = document.createComment('')\n  const lastNodePlaceholder = document.createComment('')\n  const componentsToBeUnmounted = oldComponents\n    .filter(component => !newComponents.includes(component))\n  const componentsToBeMounted = newComponents\n    .filter(component => !oldComponents.includes(component))\n  parentNode.insertBefore(firstNodePlaceholder, firstNode)\n  parentNode.insertBefore(lastNodePlaceholder, lastNode.nextSibling)\n  \n  componentsToBeUnmounted\n    .forEach(component => component.lifeCycle('beforeunmount'))\n  oldElements\n    .filter(el => !newElements.includes(el))\n    .forEach(el => parentNode.removeChild(el))\n  componentsToBeUnmounted\n    .forEach(component => component.lifeCycle('unmounted'))\n\n  const firstIndex = [...parentNode.childNodes].indexOf(firstNodePlaceholder) + 1\n\n  componentsToBeMounted\n    .forEach(component => component.lifeCycle('beforemount'))\n  newElements.forEach((el,i) => {\n    const nodeOnIndex = parentNode.childNodes[firstIndex + i]\n    if (!el.isSameNode(nodeOnIndex))\n      parentNode.insertBefore(el, nodeOnIndex)\n  })\n  componentsToBeMounted\n    .forEach(component => {\n      component.state(parentComponent.$state)\n      component.render()\n      window.requestAnimationFrame(() => {\n        component.lifeCycle('mounted')\n      })\n    })\n  \n  parentNode.removeChild(firstNodePlaceholder)\n  parentNode.removeChild(lastNodePlaceholder)\n}\n\nconst getCachedComponent = (cache, key, fn) => {\n  if (cache.has(key)) {\n    return cache.get(key)\n  }\n  else {\n    const value = fn(key)\n    if (isComponent(value)) {\n      return cache\n        .set(key, value)\n        .get(key)\n    } else {\n      return value\n    }\n  }\n}\n\nconst insertData = data => {\n  if (isPlainObject(data))\n    return new Data(data)\n  else if (isFunction(data) && data() instanceof Data)\n    return data\n  else if (isFunction(data) && isFunction(data()) && data()() instanceof Data)\n    return data()\n}\n\nconst setWatchers = (component, data, watchers) => {\n  if (!isPlainObject(watchers))\n    return\n  for (let prop in watchers) {\n    const watcher = watchers[prop]\n    let handler;\n    let deep;\n    if (isFunction(watcher)) {\n      handler = watcher\n      deep = false\n    }\n    if (isPlainObject(watcher)) {\n      handler = watcher.handler\n      deep = watcher.deep\n    }\n    data().unsubscribe(prop, handler.bind(component), `watcher`, deep)\n    data().subscribe(prop, handler.bind(component), `watcher`, deep)\n  }\n}\n\nfunction fhtml() {\n  const args = [...arguments]\n  const strings = args[0]\n  const expressions = args.length > 1\n    ? args.slice(1)\n    : []\n  const renderers = []\n  let componentState = new Data({})\n  let componentData = new Data({})\n  let componentProps = new Data({})\n  let componentAttrs = new Data({})\n  let componentWatchers = {}\n  const template = createTemplate(strings, expressions)\n  const $ctx = createRenderContext(strings[0])\n  let fhtml_placeholder\n  $ctx.insertAdjacentHTML('beforeend', template)\n  const component = {\n    mount(placeholder) {\n      fhtml_placeholder = placeholder\n      if (!placeholder || !fhtml_placeholder.parentNode)\n        return\n      replaceContent(this, this, fhtml_placeholder)\n      return this \n    },\n    unmount(returnPlaceholder = false) {\n      if (!this.$el.parentNode) return\n      this.lifeCycle('beforeunmount')\n      if (returnPlaceholder)\n        this.$el.parentNode.replaceChild(fhtml_placeholder, this.$el)\n      else\n        this.$el.parentNode.removeChild(this.$el)\n        this.lifeCycle('unmounted')\n      return this\n    },\n    lifeCycle(hook) {\n      renderers.forEach(renderer => {\n        if (renderer[hook])\n          renderer[hook](renderer, hook)\n        if (isComponent(renderer.value))\n          renderer.value.lifeCycle(hook)\n        if (isComponentArray(renderer.value)) {\n          renderer.value.forEach(component => \n            component.lifeCycle(hook)\n          )\n        }\n      })\n    },\n    state(state) {\n      componentState = insertData(state)\n      setWatchers(this, componentState, componentWatchers.state)\n      return this\n    },\n    get $state() {\n      return componentState\n    },\n    data(data) {\n      componentData = insertData(data)\n      setWatchers(this, componentData, componentWatchers.data)\n      return this\n    },\n    get $data() {\n      return componentData\n    },\n    props(props) {\n      componentProps = insertData(props)\n      setWatchers(this, componentProps, componentWatchers.props)\n      return this\n    },\n    get $props() {\n      return componentProps\n    },\n    attrs(props) {\n      componentAttrs = insertData(props)\n      setWatchers(this, componentAttrs, componentWatchers.attrs)\n      return this\n    },\n    get $attrs() {\n      return componentAttrs\n    },\n    watch(watchers) {\n      componentWatchers = watchers\n      setWatchers(this, componentState, watchers.state)\n      setWatchers(this, componentData, watchers.data)\n      setWatchers(this, componentProps, watchers.props)\n      setWatchers(this, componentAttrs, watchers.attrs)\n      return this\n    },\n    get renderers() {\n      return renderers\n    },\n    renderTimestamp: 0,\n    render() {\n      renderers.forEach(renderer => {\n        renderer.render()\n        if (isComponent(renderer.value)) {\n          renderer.value.render()\n        }\n        if (isComponentArray(renderer.value)) {\n          renderer.value.forEach(component => \n            component.render()\n          )\n        }\n      })\n      return this\n    },\n    $el: $ctx.children[0] || $ctx\n  }\n  ;[$ctx,...$ctx.querySelectorAll('*')]\n    .forEach(node => {\n      linkAttributesPropsDirectives(node, expressions, renderers, component)\n      linkContent(node, expressions, renderers, component)\n    })\n  return component\n}\n\nexport default fhtml\n"]}